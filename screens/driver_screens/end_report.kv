<EndReportScreen>:
    BoxLayout:
        orientation: 'vertical'
        
        canvas.before:
            Color:
                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
            Rectangle:
                pos: self.pos
                size: self.size
        
        # Header
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(70)
            padding: [dp(15), dp(10)]
            spacing: dp(10)
            
            canvas.before:
                Color:
                    rgba: 204/255, 197/255, 185/255, 1  # #CCC5B9
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                Line:
                    width: dp(1)
                    rectangle: (self.x, self.y, self.width, self.height)
            
            Label:
                text: "Resumen Final del Viaje"
                font_size: sp(20)
                bold: True
                halign: 'center'
                valign: 'middle'
                color: 20/255, 26/255, 28/255, 1  # #141A1C
                text_size: self.size
        
        # Área Descripción
        BoxLayout:
            size_hint_y: None
            height: dp(60)
            padding: [dp(20), dp(15)]
            
            canvas.before:
                Color:
                    rgba: 204/255, 197/255, 185/255, 1  # #CCC5B9
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                Line:
                    width: dp(1)
                    points: [self.x, self.y, self.x + self.width, self.y]
            
            Label:
                text: "Análisis de Comportamiento del Conductor"
                font_size: sp(16)
                bold: True
                halign: 'center'
                valign: 'middle'
                color: 20/255, 26/255, 28/255, 1  # #141A1C
                text_size: self.size
        
        # Contenido Principal
        BoxLayout:
            orientation: 'vertical'
            padding: [dp(15), dp(10)]
            
            ScrollView:
                do_scroll_x: False
                do_scroll_y: True
                
                canvas.before:
                    Color:
                        rgba: 204/255, 197/255, 185/255, 1  # #CCC5B9
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(12)]
                    Color:
                        rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                    Line:
                        width: dp(1)
                        rounded_rectangle: (self.x, self.y, self.width, self.height, dp(12))
                
                BoxLayout:
                    orientation: 'vertical'
                    spacing: dp(12)
                    size_hint_y: None
                    height: self.minimum_height
                    padding: [dp(18), dp(15)]
                    
                    # Reporte de Parpadeos
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(18)
                        spacing: dp(8)
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(12)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(12))
                        
                        Label:
                            text: "Reporte de Parpadeos"
                            font_size: sp(16)
                            bold: True
                            halign: 'left'
                            valign: 'top'
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1]
                        
                        Label:
                            id: final_blink_label
                            text: "Cargando datos de parpadeos..."
                            font_size: sp(14)
                            color: 20/255, 26/255, 28/255, 0.7  # text_secondary
                            halign: 'left'
                            valign: 'top'
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1] + dp(10)
                            markup: True
                    
                    # Reporte de Bostezos
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(18)
                        spacing: dp(8)
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(12)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(12))
                        
                        Label:
                            text: "Reporte de Bostezos"
                            font_size: sp(16)
                            bold: True
                            halign: 'left'
                            valign: 'top'
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1]
                        
                        Label:
                            id: final_yawn_label
                            text: "Cargando datos de bostezos..."
                            font_size: sp(14)
                            color: 20/255, 26/255, 28/255, 0.7  # text_secondary
                            halign: 'left'
                            valign: 'top'
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1] + dp(10)
                            markup: True
                    
                    # Reporte de Frotamiento de Ojos
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(18)
                        spacing: dp(8)
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(12)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(12))
                        
                        Label:
                            text: "Frotamiento de Ojos"
                            font_size: sp(16)
                            bold: True
                            halign: 'left'
                            valign: 'top'
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1]
                        
                        Label:
                            id: final_eye_rub_label
                            text: "Cargando datos de frotamiento..."
                            font_size: sp(14)
                            color: 20/255, 26/255, 28/255, 0.7  # text_secondary
                            halign: 'left'
                            valign: 'top'
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1] + dp(10)
                            markup: True
                    
                    # Reporte de Cabeceo
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(18)
                        spacing: dp(8)
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(12)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(12))
                        
                        Label:
                            text: "Cabeceo"
                            font_size: sp(16)
                            bold: True
                            halign: 'left'
                            valign: 'top'
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1]
                        
                        Label:
                            id: final_nod_label
                            text: "Cargando datos de cabeceo..."
                            font_size: sp(14)
                            color: 20/255, 26/255, 28/255, 0.7  # text_secondary
                            halign: 'left'
                            valign: 'top'
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1] + dp(10)
                            markup: True
        
        # Footer
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            padding: [dp(20), dp(10)]
            
            canvas.before:
                Color:
                    rgba: 204/255, 197/255, 185/255, 1  # #CCC5B9
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                Line:
                    width: dp(1)
                    points: [self.x, self.y + self.height, self.x + self.width, self.y + self.height]
            
            Button:
                text: "Volver al Inicio"
                size_hint: 0.7, 1
                pos_hint: {"center_x": 0.5}
                font_size: sp(14)
                bold: True
                background_color: 0, 0, 0, 0  # Transparente
                color: 20/255, 26/255, 28/255, 1  # #141A1C
                
                canvas.before:
                    Color:
                        rgba: 168/255, 159/255, 145/255, 1  # #A89F91
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8)]
                    Color:
                        rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                    Line:
                        width: dp(1)
                        rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
                
                on_press: root.go_to_home()
