<DriverMonitoringScreen>:
    canvas.before:
        Color:
            rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
        Rectangle:
            pos: self.pos
            size: self.size
    
    BoxLayout:
        orientation: 'vertical'
        
        # Header
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(70)
            padding: [dp(15), dp(10)]
            spacing: dp(10)
            
            canvas.before:
                Color:
                    rgba: 204/255, 197/255, 185/255, 1  # #CCC5B9
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                Line:
                    width: dp(1)
                    rectangle: (self.x, self.y, self.width, self.height)
            
            Label:
                text: "Monitor de Atención"
                font_size: sp(20)
                bold: True
                color: 20/255, 26/255, 28/255, 1  # #141A1C
                size_hint_x: 0.7
                halign: 'left'
                valign: 'middle'
                text_size: self.size
            
            Button:
                text: "Finalizar"
                size_hint_x: 0.3
                size_hint_y: None
                height: dp(40)
                font_size: sp(12)
                bold: True
                color: 20/255, 26/255, 28/255, 1  # #141A1C
                background_color: 0, 0, 0, 0
                
                canvas.before:
                    Color:
                        rgba: 168/255, 159/255, 145/255, 1  # #A89F91
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8)]
                    Color:
                        rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                    Line:
                        width: dp(1)
                        rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
                
                on_press: root.end_trip()
        
        # Área Descripción
        BoxLayout:
            size_hint_y: None
            height: dp(60)
            padding: [dp(20), dp(15)]
            
            canvas.before:
                Color:
                    rgba: 204/255, 197/255, 185/255, 1  # #CCC5B9
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                Line:
                    width: dp(1)
                    points: [self.x, self.y, self.x + self.width, self.y]
            
            Label:
                text: "Monitoreo en tiempo real del estado de alerta del conductor"
                font_size: sp(14)
                italic: True
                color: 20/255, 26/255, 28/255, 0.7  # #141A1C con 70% opacidad
                halign: 'center'
                valign: 'middle'
                text_size: self.size
        
        # Contenido Principal
        BoxLayout:
            orientation: 'vertical'
            padding: [dp(15), dp(10)]
            spacing: dp(12)
            
            # Video - Directo sobre el fondo
            Image:
                id: img_widget
                size_hint_y: 0.4
                canvas.before:
                    Color:
                        rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8)]
                    Color:
                        rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                    Line:
                        width: dp(1)
                        rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
            
            # Reportes - Directos sobre el fondo
            ScrollView:
                size_hint_y: 0.6
                
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(8)
                    
                    # Reporte Ojos
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: dp(60)
                        spacing: dp(5)
                        padding: [dp(15), dp(8)]
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(8)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
                        
                        Label:
                            text: "Estado de Ojos"
                            font_size: sp(14)
                            bold: True
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                        
                        Label:
                            id: eyes_message_label
                            text: "Esperando detección..."
                            font_size: sp(12)
                            color: 20/255, 26/255, 28/255, 0.7  # #141A1C con 70% opacidad
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                    
                    # Reporte Parpadeo
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: dp(60)
                        spacing: dp(5)
                        padding: [dp(15), dp(8)]
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(8)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
                        
                        Label:
                            text: "Frecuencia de Parpadeo"
                            font_size: sp(14)
                            bold: True
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                        
                        Label:
                            id: blink_message_label
                            text: "Esperando detección..."
                            font_size: sp(12)
                            color: 20/255, 26/255, 28/255, 0.7  # #141A1C con 70% opacidad
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                    
                    # Reporte Cabeceo
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: dp(60)
                        spacing: dp(5)
                        padding: [dp(15), dp(8)]
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(8)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
                        
                        Label:
                            text: "Movimiento de Cabeza"
                            font_size: sp(14)
                            bold: True
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                        
                        Label:
                            id: nod_message_label
                            text: "Esperando detección..."
                            font_size: sp(12)
                            color: 20/255, 26/255, 28/255, 0.7  # #141A1C con 70% opacidad
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                    
                    # Reporte Bostezo
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: dp(60)
                        spacing: dp(5)
                        padding: [dp(15), dp(8)]
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(8)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
                        
                        Label:
                            text: "Detección de Bostezos"
                            font_size: sp(14)
                            bold: True
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                        
                        Label:
                            id: yawn_message_label
                            text: "Esperando detección..."
                            font_size: sp(12)
                            color: 20/255, 26/255, 28/255, 0.7  # #141A1C con 70% opacidad
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                    
                    # Reporte Microsueño
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: dp(60)
                        spacing: dp(5)
                        padding: [dp(15), dp(8)]
                        
                        canvas.before:
                            Color:
                                rgba: 255/255, 252/255, 242/255, 1  # #FFFCF2
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [dp(8)]
                            Color:
                                rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                            Line:
                                width: dp(1)
                                rounded_rectangle: (self.x, self.y, self.width, self.height, dp(8))
                        
                        Label:
                            text: "Alerta de Microsueño"
                            font_size: sp(14)
                            bold: True
                            color: 20/255, 26/255, 28/255, 1  # #141A1C
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
                        
                        Label:
                            id: microsleep_message_label
                            text: "Esperando detección..."
                            font_size: sp(12)
                            color: 20/255, 26/255, 28/255, 0.7  # #141A1C con 70% opacidad
                            size_hint_y: None
                            height: dp(25)
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.size
        
        # Footer
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            padding: [dp(20), dp(10)]
            
            canvas.before:
                Color:
                    rgba: 204/255, 197/255, 185/255, 1  # #CCC5B9
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: 20/255, 26/255, 28/255, 1  # #141A1C
                Line:
                    width: dp(1)
                    points: [self.x, self.y + self.height, self.x + self.width, self.y + self.height]
            
            Label:
                id: footer_label
                text: "Estado: Iniciando..."
                font_size: sp(14)
                color: 20/255, 26/255, 28/255, 0.7  # #141A1C con 70% opacidad
                halign: 'left'
                valign: 'middle'
                text_size: self.size