<RegisterScreen>:
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1  # Fondo blanco
        Rectangle:
            pos: self.pos
            size: self.size
        Color:
            rgba: 0, 0, 0, 1  # Borde negro
        Line:
            rectangle: self.x, self.y, self.width, self.height
            width: 2

    ScrollView:
        do_scroll_x: False
        do_scroll_y: True
        
        BoxLayout:
            orientation: "vertical"
            padding: [30, 30, 30, 30]
            spacing: 20
            size_hint_y: None
            height: self.minimum_height
            
            # Título principal
            Label:
                text: "Registro de Cuenta"
                font_size: 32
                color: 0, 0, 0, 1
                size_hint_y: None
                height: "60dp"
                text_size: self.size
                halign: "center"
                valign: "middle"
                bold: True
                
            # Tipo de cuenta seleccionado
            Label:
                text: "Tipo de cuenta: " + root.account_type.title()
                font_size: 32
                color: 0, 0, 0, 1
                size_hint_y: None
                height: "40dp"
                text_size: self.size
                halign: "center"
                valign: "middle"
                
            # Espacio separador
            Widget:
                size_hint_y: None
                height: "20dp"
            
            # CAMPOS PARA COMPANY
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "company" else "0dp"
                opacity: 1 if root.account_type == "company" else 0
                spacing: 5
                
                Label:
                    text: "Nombre de la Empresa:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: company_name_input
                    text: root.company_name
                    hint_text: "Ingresa el nombre de tu empresa"
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "company" else "0dp"
                opacity: 1 if root.account_type == "company" else 0
                spacing: 5
                
                Label:
                    text: "Email de la Empresa:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: company_email_input
                    text: root.company_email
                    hint_text: "empresa@ejemplo.com"
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "company" else "0dp"
                opacity: 1 if root.account_type == "company" else 0
                spacing: 5
                
                Label:
                    text: "Contraseña:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: company_password_input
                    text: root.company_password
                    hint_text: "Mínimo 8 caracteres"
                    password: True
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "company" else "0dp"
                opacity: 1 if root.account_type == "company" else 0
                spacing: 5
                
                Label:
                    text: "Confirmar Contraseña:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: company_password_confirm_input
                    hint_text: "Confirma tu contraseña"
                    password: True
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
            
            # CAMPOS PARA DRIVER
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "driver" else "0dp"
                opacity: 1 if root.account_type == "driver" else 0
                spacing: 5
                
                Label:
                    text: "Nombre del Conductor:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: driver_name_input
                    text: root.driver_name
                    hint_text: "Ingresa tu nombre completo"
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "driver" else "0dp"
                opacity: 1 if root.account_type == "driver" else 0
                spacing: 5
                
                Label:
                    text: "Email del Conductor:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: driver_email_input
                    text: root.driver_email
                    hint_text: "conductor@ejemplo.com"
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "driver" else "0dp"
                opacity: 1 if root.account_type == "driver" else 0
                spacing: 5
                
                Label:
                    text: "Contraseña:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: driver_password_input
                    text: root.driver_password
                    hint_text: "Mínimo 8 caracteres"
                    password: True
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "driver" else "0dp"
                opacity: 1 if root.account_type == "driver" else 0
                spacing: 5
                
                Label:
                    text: "Confirmar Contraseña:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: driver_password_confirm_input
                    hint_text: "Confirma tu contraseña"
                    password: True
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
            
            # CAMPOS PARA ADMIN
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "admin" else "0dp"
                opacity: 1 if root.account_type == "admin" else 0
                spacing: 5
                
                Label:
                    text: "Nombre del Administrador:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: admin_name_input
                    hint_text: "Ingresa tu nombre completo"
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "admin" else "0dp"
                opacity: 1 if root.account_type == "admin" else 0
                spacing: 5
                
                Label:
                    text: "Email del Administrador:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: admin_email_input
                    hint_text: "admin@ejemplo.com"
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "admin" else "0dp"
                opacity: 1 if root.account_type == "admin" else 0
                spacing: 5
                
                Label:
                    text: "Contraseña:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: admin_password_input
                    hint_text: "Mínimo 8 caracteres"
                    password: True
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
                            
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type == "admin" else "0dp"
                opacity: 1 if root.account_type == "admin" else 0
                spacing: 5
                
                Label:
                    text: "Confirmar Contraseña:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                TextInput:
                    id: admin_password_confirm_input
                    hint_text: "Confirma tu contraseña"
                    password: True
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    foreground_color: 0, 0, 0, 1
                    cursor_color: 0, 0, 0, 1
                    font_size: 32
                    padding: [10, 10]
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
            
            # Spinner para seleccionar empresa (solo para driver y admin)
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "80dp" if root.account_type in ["driver", "admin"] else "0dp"
                opacity: 1 if root.account_type in ["driver", "admin"] else 0
                spacing: 5
                
                Label:
                    text: "Seleccionar Empresa:"
                    font_size: 32
                    color: 0, 0, 0, 1
                    size_hint_y: None
                    height: "25dp"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                
                Spinner:
                    id: company_spinner
                    text: "Selecciona una empresa"
                    values: root.get_company_list()
                    size_hint_y: None
                    height: "50dp"
                    background_color: 1, 1, 1, 1
                    background_normal: ''
                    color: 0, 0, 0, 1
                    font_size: 32
                    on_text: root.on_company_selected(self.text)
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1.5
            
            # Espacio separador
            Widget:
                size_hint_y: None
                height: "30dp"
            
            # Botón de registro
            Button:
                text: "Registrar Cuenta"
                size_hint_y: None
                height: "60dp"
                background_color: 1, 1, 1, 1
                background_normal: ''
                color: 0, 0, 0, 1
                font_size: 32
                bold: True
                on_press: root.register_action()
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Line:
                        rectangle: self.x, self.y, self.width, self.height
                        width: 2
                        
            # Botón volver
            Button:
                text: "Volver"
                size_hint_y: None
                height: "50dp"
                background_color: 1, 1, 1, 1
                background_normal: ''
                color: 0, 0, 0, 1
                font_size: 32
                on_press: root.go_back()
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Line:
                        rectangle: self.x, self.y, self.width, self.height
                        width: 1.5